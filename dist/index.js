(()=>{"use strict";const t="http://localhost:5500";function e(t){const e=document.createElement("div");e.classList.add("error");const n=document.createElement("p"),o=document.createTextNode(`Error: ${t}`);n.appendChild(o),e.appendChild(n),document.querySelector("body").appendChild(e),setTimeout((()=>{e.remove()}),5e3)}!async function(){const n=document.querySelector("main.posts"),o=document.querySelector(".submit"),c=await fetch("http://localhost:3000/posts").then((t=>t.json())).catch((t=>e(t)));c&&(c.map((e=>function(e){const n=document.createElement("article");n.setAttribute("class","post"),n.setAttribute("data-id",e.id);const o=document.createElement("div");o.setAttribute("class","vote-box");const c=document.createElement("img");c.src="img/upvote.png",c.classList.add("upvote");const s=document.createElement("p");s.setAttribute("class","vote"),s.textContent=e.score;const d=document.createElement("img");d.setAttribute("src","img/downvote.png"),d.setAttribute("class","downvote");const r=document.createElement("div");r.setAttribute("class","content-box");const a=document.createElement("h3");a.setAttribute("class","post-title"),a.textContent=e.title;const i=document.createElement("p");i.setAttribute("class","info");const l=function(t){const e=new Date(t),n=new Date-e;return Math.round(n/1e3/60/60/24)}(e.timestamp);i.textContent=`submitted ${l} days ago by ${e.author||"anonymus"}`;const u=document.createElement("a");u.setAttribute("class","link modify"),u.setAttribute("href",`${t}/dist/edit.html?id=${e.id}`),u.textContent="modify";const m=document.createElement("a");return m.setAttribute("class","link remove"),m.setAttribute("href","#"),m.textContent="remove",o.appendChild(c),o.appendChild(s),o.appendChild(d),r.appendChild(a),r.appendChild(i),r.appendChild(u),r.appendChild(m),n.appendChild(o),n.appendChild(r),n}(e))).forEach((t=>n.appendChild(t))),function(t){t.forEach((t=>{const n=document.querySelector(`article[data-id="${t.id}"]`);n.querySelector(".upvote").addEventListener("click",(o=>{var c;(c=t.id,fetch(`http://localhost:3000/posts/${c}/upvote`,{method:"PUT"}).then((t=>t.json())).catch((t=>e(t)))).then((t=>{n.querySelector(".vote").innerText=t.score}))})),n.querySelector(".downvote").addEventListener("click",(o=>{var c;(c=t.id,fetch(`http://localhost:3000/posts/${c}/downvote`,{method:"PUT"}).then((t=>t.json())).catch((t=>e(t)))).then((t=>n.querySelector(".vote").innerText=t.score))})),n.querySelector(".remove").addEventListener("click",(o=>{var c;o.preventDefault(),(c=t.id,fetch(`http://localhost:3000/posts/${c}`,{method:"DELETE"}).catch((t=>e(t)))).then((()=>{n.remove()}))}))}))}(c)),o.onclick=e=>{e.preventDefault(),location.href=t+"/dist/edit.html"}}()})();