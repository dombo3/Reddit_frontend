(()=>{"use strict";var e={648:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(182);const r={auth:function(){localStorage.getItem("Username")||(location.href=n.J+"/dist/login.html")},login:function(e){localStorage.setItem("Username",e)},getUser:function(){return localStorage.getItem("Username")}}},182:(e,t,o)=>{o.d(t,{T:()=>n,J:()=>r});const n="http://localhost:3000",r="http://localhost:5500"}},t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=o(182);function t(e){const t=document.createElement("div");t.classList.add("error");const o=document.createElement("p"),n=document.createTextNode(`Error: ${e}`);o.appendChild(n),t.appendChild(o),document.querySelector("body").appendChild(t),setTimeout((()=>{t.remove()}),5e3)}var n=o(648);window.onload=()=>{!async function(){const o=document.querySelector("header"),r=document.querySelector("main.posts"),c=document.querySelector(".submit"),s=document.querySelector(".logout"),a=await fetch(e.T+"/posts").then((e=>{if(e.ok)return e.json()})).catch((e=>t(e)));a&&(o.appendChild(function(){const e=document.createElement("p");e.classList.add("subtitle");const t=document.createTextNode(`${n.Z.getUser()}`);return e.appendChild(t),e}()),a.sort(((e,t)=>t.score-e.score)).map((e=>function(e){const t=document.createElement("article");t.setAttribute("class","post"),t.setAttribute("data-id",e.id);const o=document.createElement("div");o.setAttribute("class","vote-box");const n=document.createElement("img");n.src="img/upvote.png",n.classList.add("upvote");const r=document.createElement("p");r.setAttribute("class","vote"),r.textContent=e.score;const c=document.createElement("img");c.setAttribute("src","img/downvote.png"),c.setAttribute("class","downvote");const s=document.createElement("div");s.setAttribute("class","content-box");const a=document.createElement("h3");a.setAttribute("class","post-title"),a.textContent=e.title;const d=document.createElement("p");d.setAttribute("class","info");const i=function(e){const t=new Date(e),o=new Date-t;return Math.round(o/1e3/60/60/24)}(e.timestamp);d.textContent=`submitted ${i} days ago by ${e.user||"anonymus"}`;const l=document.createElement("a");l.setAttribute("class","link modify"),l.textContent="modify";const u=document.createElement("a");return u.setAttribute("class","link remove"),u.textContent="remove",o.appendChild(n),o.appendChild(r),o.appendChild(c),s.appendChild(a),s.appendChild(d),s.appendChild(l),s.appendChild(u),t.appendChild(o),t.appendChild(s),t}(e))).forEach((e=>r.appendChild(e))),function(o){o.forEach((o=>{const r=document.querySelector(`article[data-id="${o.id}"]`),c=r.querySelector(".upvote"),s=r.querySelector(".downvote"),a=r.querySelector(".remove"),d=r.querySelector(".modify");c.addEventListener("click",(n=>{var c;(c=o.id,fetch(e.T+`/posts/${c}/upvote`,{method:"PUT"}).then((e=>{if(e.ok)return e.json()})).catch((e=>t(e)))).then((e=>{r.querySelector(".vote").innerText=e.score}))})),s.addEventListener("click",(n=>{var c;(c=o.id,fetch(e.T+`/posts/${c}/downvote`,{method:"PUT"}).then((e=>{if(e.ok)return e.json()})).catch((e=>t(e)))).then((e=>{r.querySelector(".vote").innerText=e.score}))})),n.Z.getUser()===o.user?(a.addEventListener("click",(c=>{var s,a;c.preventDefault(),(s=o.id,a=n.Z.getUser(),fetch(e.T+`/posts/${s}`,{method:"DELETE",headers:{Username:a}}).catch((e=>t(e)))).then((e=>{e.ok&&r.remove()}))})),d.addEventListener("click",(t=>{t.preventDefault(),location.href=`${e.J}/dist/edit.html?id=${o.id}`}))):(a.classList.add("forbidden"),d.classList.add("forbidden"))}))}(a)),c.onclick=t=>{t.preventDefault(),location.href=e.J+"/dist/edit.html"},s.onclick=t=>{localStorage.removeItem("Username"),location.href=e.J+"/dist/login.html"}}()}})()})();